<ExtensionModel>

	<Runtime>
		<Import assembly="MonoDevelop.Packaging.dll" />
	</Runtime>

	<ConditionType id="ProjectHasNuGetMetadata" type="MonoDevelop.Packaging.ProjectHasNuGetMetadataCondition" />

	<Extension path="/MonoDevelop/ProjectModel/MSBuildItemTypes">
		<DotNetProjectType
			language="NuGet.Packaging"
			extension="nuproj"
			guid="{5DD5E4FA-CB73-4610-85AB-557B54E96AA9}"
			type="MonoDevelop.Packaging.PackagingProject"
			alias="NuGetPackaging"
			msbuildSupport="Required" />
	</Extension>

	<Extension path="/MonoDevelop/ProjectModel/ProjectModelExtensions">
		<ProjectFlavor
			id="MonoDevelop.Packaging.PackagingProjectFlavor"
			guid="{5DD5E4FA-CB73-4610-85AB-557B54E96AA9}"
			type="MonoDevelop.Packaging.PackagingProjectFlavor"
			alias="NuGetPackaging">
		</ProjectFlavor>
	</Extension>

	<!--
		Need to define a language binding otherwise it is not possible to
	 	open a .nuproj since the DotNetProject.SupportsPartialTypes is called
		when initializing a project and it requires a non-null language binding.
	-->
	<Extension path="/MonoDevelop/ProjectModel/LanguageBindings">
		<LanguageBinding
			id="NuGet.Packaging" />
	</Extension>

	<Extension path="/MonoDevelop/ProjectModel/MSBuildGlobalPropertyProviders">
		<Type
			id="NuGetPackagingMSBuildPropertyProvider"
			class="MonoDevelop.Packaging.MSBuildGlobalPropertyProvider" />
	</Extension>

	<Extension path="/MonoDevelop/Ide/ProjectTemplates">
		<ProjectTemplate id="MonoDevelop.Packaging.Project" resource="PackagingProject.xpt.xml"/>
	</Extension>

	<Extension path="/MonoDevelop/Ide/ProjectTemplateWizards">
		<Class id="MonoDevelop.Packaging.ProjectTemplateWizard" class="MonoDevelop.Packaging.Templating.PackagingProjectTemplateWizard" />
	</Extension>

	<Extension path="/MonoDevelop/ProjectModel/Gui/ItemOptionPanels">
		<Section id="NuGetPackage" _label="NuGet Package">
			<Condition id="ItemType" value="MonoDevelop.Packaging.PackagingProject|DotNetProject">
				<Section
					id="Metadata"
					_label="Metadata"
					fill="true"
					class="MonoDevelop.Packaging.OptionPanels.NuGetPackageMetadataOptionsPanel" />
			</Condition>
		</Section>
	</Extension>

	<Extension path="/MonoDevelop/Ide/Commands">
		<Category _name="NuGet" id="NuGet">
			<Command
				id="MonoDevelop.Packaging.Commands.CreateNuGetPackage"
				_description="Creates a NuGet package"
				_label="Create NuGet _Package"
				defaultHandler="MonoDevelop.Packaging.CreateNuGetPackageHandler" />
		</Category>
	</Extension>

	<Extension path="/MonoDevelop/Ide/MainMenu/Build">
		<Condition id="ProjectHasNuGetMetadata">
			<SeparatorItem
				id="CreateNuGetPackageSeparator"
				insertafter="MonoDevelop.Ide.Commands.ProjectCommands.Clean"
				insertbefore="Separator1" />
			<CommandItem
				id="MonoDevelop.Packaging.Commands.CreateNuGetPackage"
				insertafter="CreateNuGetPackageSeparator"
				insertbefore="Separator1" />
		</Condition>
	</Extension>

	<Extension path="/MonoDevelop/Ide/ContextMenu/ProjectPad">
		<Condition id="ProjectHasNuGetMetadata">
			<SeparatorItem
				id="CreateNuGetPackageSeparator"
				insertafter="MonoDevelop.Ide.Commands.ProjectCommands.Unload"
				insertbefore="MonoDevelop.Ide.Commands.ProjectCommands.CustomCommandList" />
			<CommandItem
				id="MonoDevelop.Packaging.Commands.CreateNuGetPackage"
				insertafter="CreateNuGetPackageSeparator"
				insertbefore="MonoDevelop.Ide.Commands.ProjectCommands.CustomCommandList" />
		</Condition>
	</Extension>

	<Extension path="/MonoDevelop/DesignerSupport/PropertyProviders">
		<Class class="MonoDevelop.Packaging.NuGetFilePropertyProvider" />
	</Extension>
</ExtensionModel>
